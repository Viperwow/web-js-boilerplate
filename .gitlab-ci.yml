image: node:8.14.0-jessie

cache:
  key: "$CI_COMMIT_REF_SLUG"
  paths:
    - node_modules
    - jest-results.json

stages:
  - install
  - testing
  - linting

before_script:
  - yarn install --ignore-engines

dependencies:
  stage: install
  script:
    - echo "Dependencies successfully installed"
  only:
    - branches

jest:
  stage: testing
  script:
    - yarn test:jest:output
  only:
    - branches

eslint:
  stage: linting
  script:
    - yarn test:eslint
  only:
    - branches

stylelint:
  stage: linting
  script:
    - yarn test:stylelint
  only:
    - branches

flow:
  stage: linting
  script:
    - yarn test:flow
  only:
    - branches
